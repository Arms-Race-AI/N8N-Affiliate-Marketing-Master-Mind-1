    const buf = new Uint8Array(await file.arrayBuffer());
    const wb = XLSX.read(buf, {type:'array'});
    const sheets=[];
    for(const sheetName of wb.SheetNames||[]){
      const sheet = wb.Sheets[sheetName];
      if(!sheet) continue;
      const rows = XLSX.utils.sheet_to_json(sheet, { defval:'', raw:false });
      if(rows && rows.length) sheets.push({ name:sheetName, rows });
    }
    return sheets;
  }
  function takeArrayCandidates(ctx, info, rows){
    const candidates = analyzeTabular(rows);
    for(const cand of candidates){
      ingestCandidate(ctx, cand.kind, cand, info.path);
    }
  }
  function handleJsonStructure(ctx, info, obj){
    if(!obj) return false;
    if(isLikelyGeoJSON(obj)){
